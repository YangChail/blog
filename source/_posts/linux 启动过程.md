---
title: linux 启动过程
date: 2017-04-11 12:08:13
tags: ogg
---

1: 启动电源后，主机第一步先做的就是查询BIOS(全称:basic input/output system 基本输入输出系统)信息。了解整个系统的硬件状态，如CPU，内存，显卡，网卡等。嗯，这一步windows算和它是一家。不分彼此。


----------


2: 接下来，就是主机读取MBR(硬盘的第一个扇区)里的boot loader了。


----------


4:第一个运行程序是谁?就是/sbin/init程序。不信，就用top程序看下，是不是PID为1的就是这个东东，它，可是万物之祖啊，我简称它是女娲娘娘(不喜欢亚当夏娃)。


----------


5: init首先查找启动等级(run-level)。因为启动等级不同，其运行脚本(也就是服务)会不同。默认的等级有以下几项:
　　0 - halt (系统直接关机)
　　1 - single user mode (单人模式，用于系统维护时使用)
　　2 - Multi-user， without NFS (类似3模式，不过少了NFS服务)
　　3 - Full multi-user mode (完整模式，不过，是文本模式)
　　4 - unused (系统保留功能)
　　5 - X11 (与3模式类似，不过，是X终端显示)
　　6 - reboot (重新开机)
　　(不要选择0或4，6 否则，进步了系统的)
　　


----------


 6: 系统知道自己的启动等级后，接下来，不是去启动服务，而是，先设置好主机运行环境。读取的文件是/etc/rc.d/rc.sysinit文件。那究竟要设置哪些环境呢?
　　· 设置网络环境/etc/sysconfig/network，如主机名，网关，IP，DNS等。
　　· 挂载/proc。此文件是个特殊文件，大小为0，因为它是在内存当中。里面东东最好别删。
　　· 根据内核在开机时的结果/proc/sys/kernel/modprobe。开始进行周边设备的侦测。
　　· 载入用户自定义的模块/etc/sysconfig/modules/*.modules
　　· 读取/etc/sysctl.conf文件对内核进行设定。
　　· 设定时间，终端字体，硬盘LVM或RAID功能，以fsck进行磁盘检测。


----------


7: 接下来，就是启动系统服务了，不同的run-level会有不同的服务启动。到/etc/rc.d目录中，不同的level会有不同的目录。如启动3模式，会有个rc3.d目录，里面就保存着服务。其中，S(start)开头的表明开机启动，K(kill)开头的表明开机不启动。数字表示启动顺序。数字越小，启动越早。
　　注意，他们都是连接到etc/rc.d/init.d/目录中的相关文件。所以，想手工启动某一服务，可以用"/etc/rc.d/init.d/某个服务 start"启动哦。相反，我们也可以把某个服务ln(链接命令)到不同run-level的目录中。记得打上S或者K+数字哦。
　　


----------


8: 读取服务后，主机会读取/etc/rc.d/rc.local文件。所以，如果需要什么开机启动的话，可以写个脚本或命令到这里面来。就不用像上面那么麻烦。以后删除也方便。
　